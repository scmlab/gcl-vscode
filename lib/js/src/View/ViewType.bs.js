// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Json_decode = require("@glennsl/bs-json/lib/js/src/Json_decode.bs.js");
var Json_encode = require("@glennsl/bs-json/lib/js/src/Json_encode.bs.js");
var GCL$Guacamole = require("../GCL.bs.js");
var Util$Guacamole = require("../Util/Util.bs.js");
var Response$Guacamole = require("../Response.bs.js");

var decode = Util$Guacamole.Decode.sum(function (x) {
      switch (x) {
        case "Connected" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Connected */2;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Connecting" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Connecting */1;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Disconnected" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Disconnected */0;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[LSPClientStatus] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

function encode(x) {
  switch (x) {
    case /* Disconnected */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Disconnected"
                    ],
                    tl: /* [] */0
                  });
    case /* Connecting */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Connecting"
                    ],
                    tl: /* [] */0
                  });
    case /* Connected */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Connected"
                    ],
                    tl: /* [] */0
                  });
    
  }
}

var LSPClientStatus = {
  decode: decode,
  encode: encode
};

var decode$1 = Util$Guacamole.Decode.sum(function (x) {
      switch (x) {
        case "Display" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 4,
                                              _0: param[0],
                                              _1: param[1],
                                              _2: param[2],
                                              [Symbol.for("name")]: "Display"
                                            };
                                    }), (function (param) {
                                      return Json_decode.tuple3(Json_decode.$$int, (function (param) {
                                                    return Json_decode.array(Response$Guacamole.ProofObligation.decode, param);
                                                  }), (function (param) {
                                                    return Json_decode.array(Response$Guacamole.GlobalProp.decode, param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "SetErrorMessages" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (msgs) {
                                      return {
                                              TAG: 3,
                                              _0: msgs,
                                              [Symbol.for("name")]: "SetErrorMessages"
                                            };
                                    }), (function (param) {
                                      return Json_decode.array((function (param) {
                                                    return Json_decode.pair(Json_decode.string, Json_decode.string, param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Substitute" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 2,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "Substitute"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.$$int, GCL$Guacamole.Syntax.Expr.decode, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "UpdateConnectionStatus" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (status) {
                                      return {
                                              TAG: 1,
                                              _0: status,
                                              [Symbol.for("name")]: "UpdateConnectionStatus"
                                            };
                                    }), decode, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "UpdateDevMode" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (devMode) {
                                      return {
                                              TAG: 0,
                                              _0: devMode,
                                              [Symbol.for("name")]: "UpdateDevMode"
                                            };
                                    }), Json_decode.bool, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Request] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

function encode$1(x) {
  switch (x.TAG | 0) {
    case /* UpdateDevMode */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "UpdateDevMode"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        x._0
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* UpdateConnectionStatus */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "UpdateConnectionStatus"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        encode(x._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Substitute */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Substitute"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.pair((function (prim) {
                                return prim;
                              }), GCL$Guacamole.Syntax.Expr.encode, [
                              x._0,
                              x._1
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* SetErrorMessages */3 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "SetErrorMessages"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.array((function (param) {
                                return Json_encode.pair((function (prim) {
                                              return prim;
                                            }), (function (prim) {
                                              return prim;
                                            }), param);
                              }), x._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Display */4 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Display"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.tuple3((function (prim) {
                                return prim;
                              }), (function (param) {
                                return Json_encode.array(Response$Guacamole.ProofObligation.encode, param);
                              }), (function (param) {
                                return Json_encode.array(Response$Guacamole.GlobalProp.encode, param);
                              }), [
                              x._0,
                              x._1,
                              x._2
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    
  }
}

var $$Request = {
  LSPClientStatus: LSPClientStatus,
  decode: decode$1,
  encode: encode$1
};

var decodeLinkEvent = Util$Guacamole.Decode.sum(function (x) {
      switch (x) {
        case "MouseClick" :
            return {
                    TAG: 0,
                    _0: (function (loc) {
                        return {
                                TAG: 2,
                                _0: Curry._1(GCL$Guacamole.Loc.decode, loc),
                                [Symbol.for("name")]: "MouseClick"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "MouseOut" :
            return {
                    TAG: 0,
                    _0: (function (loc) {
                        return {
                                TAG: 1,
                                _0: Curry._1(GCL$Guacamole.Loc.decode, loc),
                                [Symbol.for("name")]: "MouseOut"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "MouseOver" :
            return {
                    TAG: 0,
                    _0: (function (loc) {
                        return {
                                TAG: 0,
                                _0: Curry._1(GCL$Guacamole.Loc.decode, loc),
                                [Symbol.for("name")]: "MouseOver"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Response.linkEvent] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

var decode$2 = Util$Guacamole.Decode.sum(function (x) {
      switch (x) {
        case "Destroyed" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Destroyed */2;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "ExportProofObligations" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* ExportProofObligations */0;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Initialized" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Initialized */1;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Link" :
            return {
                    TAG: 0,
                    _0: (function (json) {
                        return {
                                TAG: 0,
                                _0: Curry._1(decodeLinkEvent, json),
                                [Symbol.for("name")]: "Link"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Substitute" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 1,
                                              _0: param[0],
                                              _1: param[1],
                                              _2: param[2],
                                              [Symbol.for("name")]: "Substitute"
                                            };
                                    }), (function (param) {
                                      return Json_decode.tuple3(Json_decode.$$int, GCL$Guacamole.Syntax.Expr.decode, GCL$Guacamole.Syntax.Expr.decodeSubst, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Response.t] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

function encodeLinkEvent(x) {
  switch (x.TAG | 0) {
    case /* MouseOver */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "MouseOver"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        GCL$Guacamole.Loc.encode(x._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* MouseOut */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "MouseOut"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        GCL$Guacamole.Loc.encode(x._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* MouseClick */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "MouseClick"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        GCL$Guacamole.Loc.encode(x._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    
  }
}

function encode$2(x) {
  if (typeof x !== "number") {
    if (x.TAG === /* Link */0) {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Link"
                  ],
                  tl: {
                    hd: [
                      "contents",
                      encodeLinkEvent(x._0)
                    ],
                    tl: /* [] */0
                  }
                });
    } else {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Substitute"
                  ],
                  tl: {
                    hd: [
                      "contents",
                      Json_encode.tuple3((function (prim) {
                              return prim;
                            }), GCL$Guacamole.Syntax.Expr.encode, GCL$Guacamole.Syntax.Expr.encodeSubst, [
                            x._0,
                            x._1,
                            x._2
                          ])
                    ],
                    tl: /* [] */0
                  }
                });
    }
  }
  switch (x) {
    case /* ExportProofObligations */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "ExportProofObligations"
                    ],
                    tl: /* [] */0
                  });
    case /* Initialized */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Initialized"
                    ],
                    tl: /* [] */0
                  });
    case /* Destroyed */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Destroyed"
                    ],
                    tl: /* [] */0
                  });
    
  }
}

var $$Response = {
  decodeLinkEvent: decodeLinkEvent,
  decode: decode$2,
  encodeLinkEvent: encodeLinkEvent,
  encode: encode$2
};

exports.$$Request = $$Request;
exports.$$Response = $$Response;
/* decode Not a pure module */
