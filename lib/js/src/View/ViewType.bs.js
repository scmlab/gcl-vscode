// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Json_decode = require("@glennsl/bs-json/lib/js/src/Json_decode.bs.js");
var Json_encode = require("@glennsl/bs-json/lib/js/src/Json_encode.bs.js");
var GCL$Guacamole = require("../GCL.bs.js");
var Link$Guacamole = require("./Link.bs.js");
var Util$Guacamole = require("../Util/Util.bs.js");
var Element$Guacamole = require("./Element.bs.js");

var decode = Util$Guacamole.Decode.sum(function (x) {
      switch (x) {
        case "ViaPrebuilt" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 2,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "ViaPrebuilt"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.string, Json_decode.string, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ViaStdIO" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "ViaStdIO"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.string, Json_decode.string, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ViaTCP" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (port) {
                                      return {
                                              TAG: 1,
                                              _0: port,
                                              [Symbol.for("name")]: "ViaTCP"
                                            };
                                    }), Json_decode.$$int, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[ConnectionMethod] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

function encode(x) {
  switch (x.TAG | 0) {
    case /* ViaStdIO */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "ViaStdIO"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.pair((function (prim) {
                                return prim;
                              }), (function (prim) {
                                return prim;
                              }), [
                              x._0,
                              x._1
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* ViaTCP */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "ViaTCP"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        x._0
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* ViaPrebuilt */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "ViaPrebuilt"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.pair((function (prim) {
                                return prim;
                              }), (function (prim) {
                                return prim;
                              }), [
                              x._0,
                              x._1
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    
  }
}

var ConnectionMethod = {
  decode: decode,
  encode: encode
};

var decode$1 = Util$Guacamole.Decode.sum(function (x) {
      switch (x) {
        case "Display" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 2,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "Display"
                                            };
                                    }), (function (param) {
                                      return Json_decode.tuple2(Json_decode.$$int, (function (param) {
                                                    return Json_decode.array(Element$Guacamole.Block.decode, param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Substitute" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 1,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "Substitute"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.$$int, GCL$Guacamole.Syntax.Expr.decode, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "UpdateConnection" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (method) {
                                      return {
                                              TAG: 0,
                                              _0: method,
                                              [Symbol.for("name")]: "UpdateConnection"
                                            };
                                    }), (function (param) {
                                      return Json_decode.optional(decode, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Request] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

function encode$1(x) {
  switch (x.TAG | 0) {
    case /* UpdateConnection */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "UpdateConnection"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.nullable(encode, x._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Substitute */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Substitute"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.pair((function (prim) {
                                return prim;
                              }), GCL$Guacamole.Syntax.Expr.encode, [
                              x._0,
                              x._1
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Display */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Display"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.tuple2((function (prim) {
                                return prim;
                              }), (function (param) {
                                return Json_encode.array(Element$Guacamole.Block.encode, param);
                              }), [
                              x._0,
                              x._1
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    
  }
}

var $$Request = {
  decode: decode$1,
  encode: encode$1
};

var decode$2 = Util$Guacamole.Decode.sum(function (x) {
      switch (x) {
        case "Destroyed" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Destroyed */2;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "ExportProofObligations" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* ExportProofObligations */0;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Initialized" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Initialized */1;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Link" :
            return {
                    TAG: 0,
                    _0: (function (json) {
                        return {
                                TAG: 0,
                                _0: Curry._1(Link$Guacamole.$$Event.decode, json),
                                [Symbol.for("name")]: "Link"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Substitute" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 1,
                                              _0: param[0],
                                              _1: param[1],
                                              _2: param[2],
                                              [Symbol.for("name")]: "Substitute"
                                            };
                                    }), (function (param) {
                                      return Json_decode.tuple3(Json_decode.$$int, GCL$Guacamole.Syntax.Expr.decode, (function (param) {
                                                    return Json_decode.array((function (param) {
                                                                  return Json_decode.pair(GCL$Guacamole.Syntax.Name.decode, GCL$Guacamole.Syntax.Expr.decode, param);
                                                                }), param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Response.t] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

function encode$2(x) {
  if (typeof x !== "number") {
    if (x.TAG === /* Link */0) {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Link"
                  ],
                  tl: {
                    hd: [
                      "contents",
                      Link$Guacamole.$$Event.encode(x._0)
                    ],
                    tl: /* [] */0
                  }
                });
    } else {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Substitute"
                  ],
                  tl: {
                    hd: [
                      "contents",
                      Json_encode.tuple3((function (prim) {
                              return prim;
                            }), GCL$Guacamole.Syntax.Expr.encode, (function (param) {
                              return Json_encode.array((function (param) {
                                            return Json_encode.pair(GCL$Guacamole.Syntax.Name.encode, GCL$Guacamole.Syntax.Expr.encode, param);
                                          }), param);
                            }), [
                            x._0,
                            x._1,
                            x._2
                          ])
                    ],
                    tl: /* [] */0
                  }
                });
    }
  }
  switch (x) {
    case /* ExportProofObligations */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "ExportProofObligations"
                    ],
                    tl: /* [] */0
                  });
    case /* Initialized */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Initialized"
                    ],
                    tl: /* [] */0
                  });
    case /* Destroyed */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Destroyed"
                    ],
                    tl: /* [] */0
                  });
    
  }
}

var $$Response = {
  decode: decode$2,
  encode: encode$2
};

exports.ConnectionMethod = ConnectionMethod;
exports.$$Request = $$Request;
exports.$$Response = $$Response;
/* decode Not a pure module */
