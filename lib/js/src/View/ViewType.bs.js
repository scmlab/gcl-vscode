// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Json_decode = require("@glennsl/bs-json/lib/js/src/Json_decode.bs.js");
var Json_encode = require("@glennsl/bs-json/lib/js/src/Json_encode.bs.js");
var GCL$Guacamole = require("../GCL.bs.js");
var Util$Guacamole = require("../Util/Util.bs.js");
var Response$Guacamole = require("../Response.bs.js");

var decode = Util$Guacamole.Decode.sum(function (tag) {
      switch (tag) {
        case "Error" :
            return {
                    TAG: 0,
                    _0: (function (json) {
                        return {
                                TAG: 1,
                                _0: Json_decode.string(json),
                                [Symbol.for("name")]: "Error"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Loading" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return /* Loading */0;
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Plain" :
            return {
                    TAG: 0,
                    _0: (function (json) {
                        return {
                                TAG: 0,
                                _0: Json_decode.string(json),
                                [Symbol.for("name")]: "Plain"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Request.Header] Unknown constructor: " + tag,
                Error: new Error()
              };
      }
    });

function encode(s) {
  if (typeof s === "number") {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "Loading"
                ],
                tl: /* [] */0
              });
  } else if (s.TAG) {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "Error"
                ],
                tl: {
                  hd: [
                    "contents",
                    s._0
                  ],
                  tl: /* [] */0
                }
              });
  } else {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "Plain"
                ],
                tl: {
                  hd: [
                    "contents",
                    s._0
                  ],
                  tl: /* [] */0
                }
              });
  }
}

var Header = {
  decode: decode,
  encode: encode
};

var decode$1 = Util$Guacamole.Decode.sum(function (tag) {
      switch (tag) {
        case "Nothing" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return /* Nothing */0;
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Plain" :
            return {
                    TAG: 0,
                    _0: (function (json) {
                        return {
                                TAG: 1,
                                _0: Json_decode.string(json),
                                [Symbol.for("name")]: "Plain"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ProofObligations" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: param[0],
                                              _1: param[1],
                                              _2: param[2],
                                              [Symbol.for("name")]: "ProofObligations"
                                            };
                                    }), (function (param) {
                                      return Json_decode.tuple3(Json_decode.$$int, (function (param) {
                                                    return Json_decode.array(Response$Guacamole.ProofObligation.decode, param);
                                                  }), (function (param) {
                                                    return Json_decode.array(Response$Guacamole.GlobalProp.decode, param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Request.Header] Unknown constructor: " + tag,
                Error: new Error()
              };
      }
    });

function encode$1(x) {
  if (typeof x === "number") {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "Nothing"
                ],
                tl: /* [] */0
              });
  } else if (x.TAG) {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "Plain"
                ],
                tl: {
                  hd: [
                    "contents",
                    x._0
                  ],
                  tl: /* [] */0
                }
              });
  } else {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "ProofObligations"
                ],
                tl: {
                  hd: [
                    "contents",
                    Json_encode.tuple3((function (prim) {
                            return prim;
                          }), (function (param) {
                            return Json_encode.array(Response$Guacamole.ProofObligation.encode, param);
                          }), (function (param) {
                            return Json_encode.array(Response$Guacamole.GlobalProp.encode, param);
                          }), [
                          x._0,
                          x._1,
                          x._2
                        ])
                  ],
                  tl: /* [] */0
                }
              });
  }
}

var Body = {
  decode: decode$1,
  encode: encode$1
};

var decode$2 = Util$Guacamole.Decode.sum(function (tag) {
      switch (tag) {
        case "Display" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 1,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "Display"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(decode, decode$1, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Hide" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return /* Hide */1;
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Show" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return /* Show */0;
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Substitute" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "Substitute"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.$$int, GCL$Guacamole.Syntax.Expr.decode, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Request] Unknown constructor: " + tag,
                Error: new Error()
              };
      }
    });

function encode$2(param) {
  if (typeof param === "number") {
    if (param === /* Show */0) {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Show"
                  ],
                  tl: /* [] */0
                });
    } else {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Hide"
                  ],
                  tl: /* [] */0
                });
    }
  } else if (param.TAG) {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "Display"
                ],
                tl: {
                  hd: [
                    "contents",
                    Json_encode.pair(encode, encode$1, [
                          param._0,
                          param._1
                        ])
                  ],
                  tl: /* [] */0
                }
              });
  } else {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "Substitute"
                ],
                tl: {
                  hd: [
                    "contents",
                    Json_encode.pair((function (prim) {
                            return prim;
                          }), GCL$Guacamole.Syntax.Expr.encode, [
                          param._0,
                          param._1
                        ])
                  ],
                  tl: /* [] */0
                }
              });
  }
}

var $$Request = {
  Header: Header,
  Body: Body,
  decode: decode$2,
  encode: encode$2
};

var decodeMode = Util$Guacamole.Decode.sum(function (tag) {
      switch (tag) {
        case "WP1" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* WP1 */0;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "WP2" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* WP2 */1;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Response.mode] Unknown constructor: " + tag,
                Error: new Error()
              };
      }
    });

var decodeLinkEvent = Util$Guacamole.Decode.sum(function (tag) {
      switch (tag) {
        case "MouseClick" :
            return {
                    TAG: 0,
                    _0: (function (loc) {
                        return {
                                TAG: 2,
                                _0: Curry._1(GCL$Guacamole.Loc.decode, loc),
                                [Symbol.for("name")]: "MouseClick"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "MouseOut" :
            return {
                    TAG: 0,
                    _0: (function (loc) {
                        return {
                                TAG: 1,
                                _0: Curry._1(GCL$Guacamole.Loc.decode, loc),
                                [Symbol.for("name")]: "MouseOut"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "MouseOver" :
            return {
                    TAG: 0,
                    _0: (function (loc) {
                        return {
                                TAG: 0,
                                _0: Curry._1(GCL$Guacamole.Loc.decode, loc),
                                [Symbol.for("name")]: "MouseOver"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Response.linkEvent] Unknown constructor: " + tag,
                Error: new Error()
              };
      }
    });

var decode$3 = Util$Guacamole.Decode.sum(function (tag) {
      switch (tag) {
        case "Destroyed" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Destroyed */1;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Initialized" :
            return {
                    TAG: 1,
                    _0: (function (param) {
                        return /* Initialized */0;
                      }),
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "Link" :
            return {
                    TAG: 0,
                    _0: (function (json) {
                        return {
                                TAG: 1,
                                _0: Curry._1(decodeLinkEvent, json),
                                [Symbol.for("name")]: "Link"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "SetMode" :
            return {
                    TAG: 0,
                    _0: (function (json) {
                        return {
                                TAG: 0,
                                _0: Curry._1(decodeMode, json),
                                [Symbol.for("name")]: "SetMode"
                              };
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "Substitute" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 2,
                                              _0: param[0],
                                              _1: param[1],
                                              _2: param[2],
                                              [Symbol.for("name")]: "Substitute"
                                            };
                                    }), (function (param) {
                                      return Json_decode.tuple3(Json_decode.$$int, GCL$Guacamole.Syntax.Expr.decode, GCL$Guacamole.Syntax.Expr.decodeSubst, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[Response.t] Unknown constructor: " + tag,
                Error: new Error()
              };
      }
    });

function encodeMode(param) {
  if (param) {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "WP2"
                ],
                tl: /* [] */0
              });
  } else {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "WP1"
                ],
                tl: /* [] */0
              });
  }
}

function encodeLinkEvent(loc) {
  switch (loc.TAG | 0) {
    case /* MouseOver */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "MouseOver"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        GCL$Guacamole.Loc.encode(loc._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* MouseOut */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "MouseOut"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        GCL$Guacamole.Loc.encode(loc._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* MouseClick */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "MouseClick"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        GCL$Guacamole.Loc.encode(loc._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    
  }
}

function encode$3(e) {
  if (typeof e === "number") {
    if (e === /* Initialized */0) {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Initialized"
                  ],
                  tl: /* [] */0
                });
    } else {
      return Json_encode.object_({
                  hd: [
                    "tag",
                    "Destroyed"
                  ],
                  tl: /* [] */0
                });
    }
  }
  switch (e.TAG | 0) {
    case /* SetMode */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "SetMode"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        encodeMode(e._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Link */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Link"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        encodeLinkEvent(e._0)
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Substitute */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Substitute"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.tuple3((function (prim) {
                                return prim;
                              }), GCL$Guacamole.Syntax.Expr.encode, GCL$Guacamole.Syntax.Expr.encodeSubst, [
                              e._0,
                              e._1,
                              e._2
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    
  }
}

var $$Response = {
  decodeMode: decodeMode,
  decodeLinkEvent: decodeLinkEvent,
  decode: decode$3,
  encodeMode: encodeMode,
  encodeLinkEvent: encodeLinkEvent,
  encode: encode$3
};

exports.$$Request = $$Request;
exports.$$Response = $$Response;
/* decode Not a pure module */
