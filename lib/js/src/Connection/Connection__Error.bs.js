// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Json = require("@glennsl/bs-json/lib/js/src/Json.bs.js");
var Belt_Option = require("rescript/lib/js/belt_Option.js");
var Util$Guabao = require("../Util/Util.bs.js");
var Source$LanguageServerMule = require("language-server-mule/lib/js/src/Source.bs.js");

function toString(error) {
  switch (error.TAG | 0) {
    case /* CannotAcquireHandle */0 :
        return [
                "Cannot acquire \"gcl\"",
                Source$LanguageServerMule.$$Error.toString(error._0)
              ];
    case /* LSPClientError */1 :
        return [
                "LSP connection error",
                Util$Guabao.Exn.toString(error._0)
              ];
    case /* ConnectionError */2 :
        var exn = error._0;
        var isECONNREFUSED = Belt_Option.mapWithDefault(exn.message, false, (function (param) {
                return param.startsWith("connect ECONNREFUSED");
              }));
        if (isECONNREFUSED) {
          return [
                  "LSP Connection Error",
                  "Please enter \":main -d\" in ghci"
                ];
        } else {
          return [
                  "LSP Client Error",
                  Belt_Option.getWithDefault(exn.message, "")
                ];
        }
    case /* CannotSendRequest */3 :
        return [
                "PANIC: Cannot send request",
                "Please file an issue\n" + Belt_Option.getWithDefault(error._0.message, "")
              ];
    case /* CannotDecodeResponse */4 :
        return [
                "PANIC: Cannot decode response",
                "Please file an issue\n\n" + error._0 + "\n" + Json.stringify(error._1)
              ];
    
  }
}

exports.toString = toString;
/* Util-Guabao Not a pure module */
