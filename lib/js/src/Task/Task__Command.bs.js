// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var $$Promise = require("reason-promise/lib/js/src/js/promise.js");
var Belt_Option = require("bs-platform/lib/js/belt_Option.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");
var Task__Types$Guacamole = require("./Task__Types.bs.js");

function Impl(Editor, State) {
  var partial_arg = Task__Types$Guacamole.Impl;
  var Task__Types = (function (param) {
        return partial_arg(Editor, param);
      })(State);
  var State$1 = Curry._1(State, Editor);
  var dispatch = function (param) {
    if (param !== 0) {
      return /* [] */0;
    } else {
      return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                /* WithState */Caml_chrome_debugger.variant("WithState", 0, [(function (state) {
                        var editor = Curry._1(Task__Types.State.getEditor, state);
                        return Belt_Option.mapWithDefault(Curry._1(Editor.getFileName, editor), $$Promise.resolved(/* [] */0), (function (fileName) {
                                      return $$Promise.map(Curry._1(Editor.save, editor), (function (saveSucceed) {
                                                    if (saveSucceed && fileName !== "") {
                                                      return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                                /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 2, [/* Load */Caml_chrome_debugger.variant("Load", 0, [fileName])]),
                                                                /* [] */0
                                                              ]);
                                                    } else {
                                                      return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                                /* Display */Caml_chrome_debugger.variant("Display", 3, [
                                                                    /* Error */Caml_chrome_debugger.variant("Error", 1, ["Cannot read filepath"]),
                                                                    /* Plain */Caml_chrome_debugger.variant("Plain", 1, ["Please save the file first"])
                                                                  ]),
                                                                /* [] */0
                                                              ]);
                                                    }
                                                  }));
                                    }));
                      })]),
                /* [] */0
              ]);
    }
  };
  return {
          Task__Types: Task__Types,
          State: State$1,
          dispatch: dispatch
        };
}

exports.Impl = Impl;
/* Promise Not a pure module */
